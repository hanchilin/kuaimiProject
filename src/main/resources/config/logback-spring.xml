<configuration>
    <include resource="org/springframework/boot/logging/logback/base.xml"/>

	<logger name="org.apache" level="info"/>
	<logger name="org.springframework" level="info"/>
	<logger name="org.hibernate" level="info"/>
	<logger name="org.hibersap" level="warn"/>
	<!-- the filter spews out a lot of unwanted warnings about an internally deprecated method which is annoying -->
	<logger name="net.sf.ehcache.constructs.web" level="error"/>

	<logger name="org.springframework.security" level="info"/>
	<logger name="org.springframework.web" level="info"/>
	<logger name="com.kuaimi" level="debug"/>

	<!-- spring subclass is quite noisey -->
	<!--<logger name="com.labnetwork.frontend.security.preauth.PreAuthTokenHandler" level="info"/>-->

    <!-- local config -->
    <springProfile name="local">

        <property name="LOG_HOME" value="./"></property>
        <appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender">
            <encoder>
                <charset>UTF-8</charset>
                <Pattern>%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n</Pattern>
            </encoder>
        </appender>

        <appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
                    <file>${LOG_HOME}/logs/spring.log</file>

                    <filter class="ch.qos.logback.classic.filter.ThresholdFilter">
                            <level>DEBUG</level>
                    </filter>

                    <rollingPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy">
                            <fileNamePattern>${LOG_HOME}/logs/spring-%d{yyyy-MM-dd}.%i.log</fileNamePattern>
                            <maxFileSize>50KB</maxFileSize>
                            <maxHistory>18</maxHistory>
                            <totalSizeCap>6GB</totalSizeCap>
                    </rollingPolicy>

                    <encoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder">
                            <charset>UTF-8</charset>
                            <pattern>%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n</pattern>
                    </encoder>
        </appender>

        <root level="INFO">
            <!-- <appender-ref ref="CONSOLE" />-->
            <appender-ref ref="FILE"/>
        </root>

    </springProfile>

    <!-- qa dev demo config -->
    <springProfile name="qa,dev,demo">

        <property name="LOG_HOME" value="/opt/kuaimi/"></property>
        <appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
                    <file>${LOG_HOME}/logs/spring.log</file>

                    <filter class="ch.qos.logback.classic.filter.ThresholdFilter">
                            <level>DEBUG</level>
                    </filter>

                    <rollingPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy">
                            <fileNamePattern>${LOG_HOME}/logs/spring-%d{yyyy-MM-dd}.%i.log</fileNamePattern>
                            <maxFileSize>10MB</maxFileSize>
                            <maxHistory>18</maxHistory>
                            <totalSizeCap>3GB</totalSizeCap>
                    </rollingPolicy>

                    <encoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder">
                            <charset>UTF-8</charset>
                            <pattern>%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n</pattern>
                    </encoder>
        </appender>

        <root level="INFO">
            <appender-ref ref="FILE"/>
        </root>

    </springProfile>

    <!-- prod config -->
    <springProfile name="prod">

        <property name="LOG_HOME" value="/opt/kuaimi/"></property>
        <appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
                    <file>${LOG_HOME}/logs/spring.log</file>

                    <filter class="ch.qos.logback.classic.filter.ThresholdFilter">
                            <level>DEBUG</level>
                    </filter>

                    <rollingPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy">
                            <fileNamePattern>${LOG_HOME}/logs/spring-%d{yyyy-MM-dd}.%i.log</fileNamePattern>
                            <maxFileSize>10MB</maxFileSize>
                            <maxHistory>18</maxHistory>
                            <totalSizeCap>6GB</totalSizeCap>
                    </rollingPolicy>

                    <encoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder">
                            <charset>UTF-8</charset>
                            <pattern>%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n</pattern>
                    </encoder>
        </appender>

        <root level="INFO">
            <appender-ref ref="FILE"/>
        </root>

    </springProfile>

</configuration>
